<!-- saved from url=(0022)http://internet.e-mail -->
<html>

<head>
<meta http-equiv="Content-Language" content="zh-tw">
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Socket to Air COM元件 For ASP 使用說明</title>
</head>

<body>

<p align="center"><font size="5"><b>hiAir SMS JSP元件使用說明</b></font><font color="#000080" size="5"><br> 
</font><br></p>
<ul>
  <li type="square">	<p style="line-height: 150%; margin-top: 0px"><font color="#FF0000">	class放置路徑：以tomcat的首頁預設路徑為例：sms2.class需放在/tomcat安裝路徑/webapps/ROOT/WEB-INF/classes/hiairv2/ 	的目錄下</font></li>
  <li type="square">	<p style="line-height: 150%; margin-top: 0px"><font color="#FF0000">元件函式說明：</font><br>	</p>	<table border="1" width="595" cellspacing="0">		<tr>			<td width="368">			<p align="center">函式名稱</td>			<td width="217">			<p align="center">說明</td>		</tr>		<tr>			<td width="368">&nbsp;create_conn(ServerIP,ServerPort,UserID,Passwd)</td>			<td width="217">&nbsp;建立SMS伺服器連線</td>		</tr>		<tr>			<td width="368">&nbsp;send_text_message(MobileNum,Message)</td>			<td width="217">&nbsp;傳送文字簡訊</td>		</tr>		<tr>			<td width="368">&nbsp;send_text_message(MobileNum,Message,Order_Time)</td>			<td width="217">&nbsp;預約傳送文字簡訊</td>		</tr>		<tr>			<td width="368">&nbsp;query_message(Type,MessageID)</td>			<td width="217">&nbsp;查詢簡訊傳送結果</td>		</tr>		<tr>			<td width="368">&nbsp;recv_text_message( )</td>			<td width="217">&nbsp;接收手機回傳簡訊</td>		</tr>		<tr>			<td width="368">&nbsp;cancel_text_message(MessageID)</td>			<td width="217">&nbsp;取消預約文字簡訊</td>		</tr>		<tr>			<td width="368">&nbsp;ret_message( )</td>			<td width="217">&nbsp;取得系統回傳的描述</td>		</tr>		<tr>			<td width="368">&nbsp;get_msisdn( )</td>			<td width="217">&nbsp;取得手機回覆者的手機號碼</td>		</tr>		<tr>			<td width="368">&nbsp;close_conn( )</td>			<td width="217">&nbsp;結束SMS伺服器連線</td>		</tr>	</table>	<p><font color="#800000">函式參數說明：<br></font></p>	<table border="1" width="595" cellspacing="0">		<tr>			<td width="86">			<p align="center">參數名稱</td>			<td width="92">			<p align="center">參數型態</td>			<td width="148">			<p align="center">內容</td>			<td width="253">			<p align="center">說明</td>		</tr>		<tr>			<td width="86">&nbsp;ServerIP</td>			<td width="92">&nbsp;字串(string)</td>			<td width="148">&nbsp;SMS伺服器IP</td>			<td width="253">&nbsp;202.39.54.130</td>		</tr>		<tr>			<td width="86">&nbsp;ServerPort</td>			<td width="92">&nbsp;字串(string)</td>			<td width="148">&nbsp;SMS伺服器Port</td>			<td width="253">&nbsp;8000</td>		</tr>		<tr>			<td width="86">&nbsp;UserID</td>			<td width="92">&nbsp;字串(string)</td>			<td width="148">&nbsp;登入帳號</td>			<td width="253">&nbsp;最長8個字元</td>		</tr>		<tr>			<td width="86">&nbsp;Passwd</td>			<td width="92">&nbsp;字串(string)</td>			<td width="148">&nbsp;登入密碼</td>			<td width="253">&nbsp;最長16個字元</td>		</tr>		<tr>			<td width="86">&nbsp;MobileNum</td>			<td width="92">&nbsp;字串(string)</td>			<td width="148">&nbsp;手機號碼</td>			<td width="253">&nbsp;國內固定為10個字元，國外20以內</td>		</tr>		<tr>			<td width="86">&nbsp;Message</td>			<td width="92">&nbsp;字串(string)</td>			<td width="148">&nbsp;簡訊內容</td>			<td width="253">&nbsp;最長為159個字元</td>		</tr>		<tr>			<td width="86">&nbsp;Order_Time</td>			<td width="92">&nbsp;字串(string)</td>			<td width="148">&nbsp;預約傳送的時間</td>			<td width="253">&nbsp;格式:YYMMDDHHMM00(12字元)</td>		</tr>		<tr>			<td width="86">&nbsp;Type</td>			<td width="92">&nbsp;數值(int)</td>			<td width="148">&nbsp;查詢訊息的種類</td>			<td width="253">&nbsp; 2:text ,6:logo, 8:ringtone, 14:wappush</td>		</tr>		<tr>			<td width="86">&nbsp;MessageID</td>			<td width="92">&nbsp;字串(string)</td>			<td width="148">&nbsp;系統回傳的訊息ID</td>			<td width="253">&nbsp;簡訊傳送時，系統回傳的訊息ID</td>		</tr>	</table>	<p align="left"><font color="#800000">註1：</font>YYMMDDHHMM00-&gt;年月日時分秒，秒必須為00。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ex : 021210110200 
    表示西元2002年12月10日11點02分<font color="#800000"><br><br>函式回傳值說明：</font></p>	<table border="0" width="595" cellspacing="0" cellpadding="0">		<tr>			<td width="20">1.</td>			<td width="571">create_conn(ServerIP,ServerPort,UserID,Passwd)：回傳值型態為int</td>		</tr>		<tr>			<td width="20"></td>			<td width="571">　
           			<table border="1" width="299" cellspacing="0">				<tr>					<td width="56" align="center">回傳值</td>					<td width="233" align="center">內容</td>				</tr>				<tr>					<td width="56" align="center">0</td>					<td width="233">&nbsp;帳號/密碼檢查成功</td>				</tr>				<tr>					<td width="56" align="center">1</td>					<td width="233">&nbsp;密碼錯誤</td>				</tr>				<tr>					<td width="56" align="center">2</td>					<td width="233">&nbsp;帳號不存在</td>				</tr>				<tr>					<td width="56">					<p align="center">3</td>					<td width="233">&nbsp;超過准許最大連線數</td>				</tr>				<tr>					<td width="56" align="center">4</td>					<td width="233">&nbsp;帳號狀態不正確或以退租</td>				</tr>				<tr>					<td width="56" align="center">71</td>					<td width="233">&nbsp;Socket 連線失敗或傳送錯誤</td>				</tr>				<tr>					<td width="56">					<p align="center">其他值</td>					<td width="233">&nbsp;請參考hiAirV2軟體規格書</td>				</tr>			</table>			<p>　</td>		</tr>		<tr>			<td width="20">2.</td>			<td width="571">send_text_message(MobileNum,Message)：回傳值型態為int</td>		</tr>		<tr>			<td width="20"></td>			<td width="571">　
           			<table border="1" width="298" cellspacing="0">				<tr>					<td width="82" align="center">回傳值</td>					<td width="367" align="center">內容</td>				</tr>				<tr>					<td width="82" align="center">0</td>					<td width="367">&nbsp;訊息傳送成功</td>				</tr>				<tr>					<td width="82" align="center">2</td>					<td width="367">&nbsp;編碼格式錯誤</td>				</tr>				<tr>					<td width="82" align="center">6</td>					<td width="367">&nbsp;手機號碼格式</td>				</tr>				<tr>					<td width="82" align="center">8</td>					<td width="367">&nbsp;重送截止時間格式錯誤</td>				</tr>				<tr>					<td width="82" align="center">9</td>					<td width="367">&nbsp;預約傳送時間格式錯誤</td>				</tr>				<tr>					<td width="82" align="center">11</td>					<td width="367">&nbsp;系統暫時無法傳送訊息</td>				</tr>				<tr>					<td width="56" align="center">71</td>					<td width="233">&nbsp;Socket 連線失敗或傳送錯誤</td>				</tr>				<tr>					<td width="63">					<p align="center">其他值</td>					<td width="367">					<p align="left">&nbsp;請參考hiAirV2軟體規格書</td>				</tr>			</table>			<p><font color="#800000">註1：當回傳值=0，傳送成功，此時請用get_message()取得系統回覆的<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageID，以供查詢簡訊傳送結果用。<br>			<br>　</font></td>		</tr>		<tr>			<td width="20">3.</td>			<td width="571">query_message(Type,MessageID)：回傳值型態為int</td>		</tr>		<tr>			<td width="20"></td>			<td width="571">　
           			<table border="1" width="328" cellspacing="0">				<tr>					<td width="57" align="center">回傳值</td>					<td width="261" align="center">內容</td>				</tr>				<tr>					<td width="57" align="center">0</td>					<td width="261">&nbsp;訊息已送達對方</td>				</tr>				<tr>					<td width="57" align="center">1</td>					<td width="261">&nbsp;手機未開或在受訊範圍外</td>				</tr>				<tr>					<td width="57" align="center">2</td>					<td width="261">&nbsp;查詢系統無此MessageID資料</td>				</tr>				<tr>					<td width="57" align="center">3</td>					<td width="261">&nbsp;MessageID格式錯誤</td>				</tr>				<tr>					<td width="57" align="center">4</td>					<td width="261">&nbsp;已送到簡訊中心，尚未完成查詢</td>				</tr>				<tr>					<td width="57" align="center">5</td>					<td width="261">&nbsp;預約時間超過48小時</td>				</tr>				<tr>					<td width="57" align="center">8</td>					<td width="261">&nbsp;手機號碼或簡訊內容格式錯誤</td>				</tr>				<tr>					<td width="57" align="center">10</td>					<td width="261">&nbsp;簡訊已被移除或超過重送時間</td>				</tr>				<tr>					<td width="57" align="center">17</td>					<td width="261">&nbsp;訊息無法送達對方</td>				</tr>				<tr>					<td width="57" align="center">19</td>					<td width="261">&nbsp;訊息已送至簡訊中心</td>				</tr>				<tr>					<td width="57" align="center">20</td>					<td width="261">&nbsp;預約簡訊，等待傳送中</td>				</tr>				<tr>					<td width="57" align="center">21</td>					<td width="261">&nbsp;預約簡訊，已取消傳送</td>				</tr>				<tr>					<td width="57" align="center">22</td>					<td width="261">&nbsp;簡訊內容不合規定(疑似詐財簡訊)</td>				</tr>				<tr>					<td width="56" align="center">71</td>					<td width="233">&nbsp;Socket 連線失敗或傳送錯誤</td>				</tr>				<tr>					<td width="57" align="center">其他值</td>					<td width="261">&nbsp;請參考hiAirV2軟體規格書</td>				</tr>			</table>			<p><font color="#800000">註：請用get_message( )取得查詢結果的說明內容。<br>　</font></td>		</tr>		<tr>			<td width="20">4.</td>			<td width="571">recv_text_message( ): 回傳值型態為int</td>		</tr>        <tr>			<td width="20">　</td>			<td width="571">&nbsp;<table border="1" cellspacing="0" width="297" id="AutoNumber2">				<tr>					<td width="56" height="15">					<p align="center">回傳值</td>					<td width="228" height="15">					<p align="center">內容</td>				</tr>				<tr>					<td width="56" height="16" align="center">0</td>					<td width="228" height="16">&nbsp;有手機回傳簡訊</td>				</tr>				<tr>					<td width="56" height="16" align="center">1</td>					<td width="228" height="16">&nbsp;系統無手機回傳的簡訊</td>				</tr>				<tr>					<td width="56" height="16" align="center">2</td>					<td width="228" height="16">&nbsp;系統錯誤，請重試</td>				</tr>				<tr>					<td width="56" align="center">3</td>					<td width="233">&nbsp;MessageID格式錯誤</td>				</tr>				<tr>					<td width="56" align="center">71</td>					<td width="233">&nbsp;&nbsp;Socket 連線失敗或傳送錯誤</td>				</tr>			</table>			<p><font color="#800000">註：當回傳值=0，表示系統有手機回傳的簡訊，此時請用get_message( )取得<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 手機回覆的內容，用get_msisdn(             )取得回傳者的手機號碼。</font><br>　</td>		</tr>		<tr>			<td width="20">4.</td>			<td width="571">cancel_text_message(MessageID): 回傳值型態為int</td>		</tr>		<tr>			<td width="20">　</td>			<td width="571">&nbsp;<table border="1" cellspacing="0" width="435" id="AutoNumber2">				<tr>					<td width="56" height="15">					<p align="center">回傳值</td>					<td width="366" height="15">					<p align="center">內容</td>				</tr>				<tr>					<td width="56" height="16" align="center">0</td>					<td width="366" height="16">&nbsp;取消成功</td>				</tr>				<tr>					<td width="56" height="16" align="center">1</td>					<td width="366" height="16">&nbsp;目前非預約狀態，可能之前已取消或已發送成功。</td>				</tr>				<tr>					<td width="56" height="16" align="center">2</td>					<td width="366" height="16">&nbsp;查詢系統無此MessageID資料</td>				</tr>				<tr>					<td width="56" align="center">3</td>					<td width="371">&nbsp;Socket 連線失敗或傳送錯誤</td>				</tr>				<tr>					<td width="56" align="center">71</td>					<td width="371">&nbsp;Socket 連線失敗或傳送錯誤</td>				</tr>			</table>			<p><font color="#800000">註：請用get_message( )取得結果的說明內容。</font><br>　</td>		</tr>		<tr>			<td width="20">5.</td>			<td width="571"><font color="#800000">get_message( )</font>：回傳值型態為string</td>		</tr>		<tr>			<td width="20"></td>			<td width="571"></td>		</tr>		<tr>			<td width="20">　</td>			<td width="571"><br><font color="#800000">取得系統回傳的訊息。<br>			<br>註：當send_text_message( )成功傳送訊息到Server，系統會回傳MessageID，需用<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;             get_message( )取得MessageID</font><br>　</td>		</tr>		<tr>			<td width="20">6.</td>			<td width="571"><font color="#800000">get_msisdn( )</font>：回傳值型態為string</td>		</tr>		<tr>			<td width="20"></td>			<td width="571"></td>		</tr>		<tr>			<td width="20">　</td>			<td width="571"><br>回傳值為手機號碼<br><br><font color="#800000">註：當執行recv_text_message(             )取得手機回傳的簡訊時，需用get_msisdn( )取得回傳<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 者的手機號碼</font>。<br>　</td>		</tr>		<tr>			<td width="20">7.</td>			<td width="571">close_conn()：無回傳值</td>		</tr>		<tr>			<td width="20"></td>			<td width="571"></td>		</tr>		<tr>			<td width="20">　</td>			<td width="571">　</td>		</tr>		<tr>			<td width="20"></td>			<td width="571"></td>		</tr>	</table>	<p align="left">　</li>
  <li type="square"><font color="#FF0000">其他相關說明：</font><br>
    <br>
    1. create_conn( )成功建立連線後，才可使用send_text_message( )、query_message( )和<br>&nbsp;&nbsp;&nbsp; recv_text_message( )，傳送結束後，請記得使用close_conn( )結束連線。<br> 
    <br>
  2. send_text_message( )將簡訊傳送到簡訊伺服器，如果成功(回傳值=0)，則系統會回傳<br>&nbsp;&nbsp;&nbsp; 一個MessageID，請用get_message( )取得此MessageID，之後可以根據此MessageID，<br>
&nbsp;&nbsp;&nbsp; 使用query_message(  
    )查詢簡訊是否有成功傳送至GSM手機或呼叫器中。如果傳送不<br>&nbsp;&nbsp;&nbsp; 成功(回傳值!=0)，可以用get_message( )取得系統回覆的訊息。<br> 
    <br>
    3. 執行RecvMsg接收回傳的簡訊，如果成功(回傳值=0)，請用Get_Ret_Content取得回傳<br>&nbsp;&nbsp;&nbsp; 的簡訊內容，用Get_Send_MSISDN取得回傳者的手機號碼。<br> 
    <br>
  4. 如欲一次傳送多筆簡訊，請於create_conn( )成功建立連結後，多次執行send_text_<br>&nbsp;&nbsp;&nbsp; message( )即可。<br>
  <br>
  5. 簡訊伺服器，同一帳號最多可建立五個Connection。<br>
    <br>
  </li>
</ul>

</body>

</html>